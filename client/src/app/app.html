<app-navigation 
  [currentView]="currentView()" 
  (navigate)="navigateTo($event)">
</app-navigation>

<div class="main-content">
  
  <div class="blog-content">
    @if (currentView() === 'about') {
      <div class="about-mobile-wrapper">
        <app-about></app-about>
      </div>
    } @else if (currentView() === 'posts') {
      <div class="blog-posts">
        @if (loading()) {
          <div class="loading">Loading posts...</div>
        } @else if (error()) {
          <div class="error">{{ error() }}</div>
        } @else {
          @for (post of posts(); track post.id) {
            <article class="blog-post">
              <h3><a [routerLink]="['/post', post.id]">{{ post.title }}</a></h3>
              <div class="post-date">{{ formatDate(post.createdAt) }}</div>
              <div class="post-content" [innerHTML]="sanitizeHtml(post.content)"></div>
            </article>
          }
        }
      </div>
    } @else if (currentView() === 'facilities') {
      <div class="facilities-content">
        <div id="facilitiesContainer">
          <div class="facilitiesBlock">
            <h2>The Barn</h2>
            <img src="https://www.hvflyingcircus.com/wp-content/uploads/2025/07/IMG_0752-1024x768.jpg" alt="The Barn at Hudson Valley Flying Circus" />
            <p>The Barn is one of two main practice areas at The Flying Circus and houses 2 pits, over 225 poles and several apparatus for off the pit drills. The barn is also wired with a high tech camera system to give instant replays of jumps as well as a speaker system for music to be enjoyed both indoors and out.</p>
          </div>
          
          <div class="facilitiesBlock">
            <h2>Outdoor Facility</h2>
            <div class="video-wrapper">
              <iframe src="https://www.youtube.com/embed/hE4dGHdYMho" frameborder="0" allowfullscreen></iframe>
            </div>
            <p>The outdoor facility also has three pits, for a total of five. Two are opposite each other and share a runway. Having five pits allows us split up our vaulters into different groups for a better learning experience that is targeted toward their ability. Having both indoor and outdoor facilities also allows us to practice and compete year round, rain or shine.</p>
          </div>
        </div>
      </div>
    } @else if (currentView() === 'staff') {
      <app-staff></app-staff>
    }
    
    <div class="blog-sidebar">
      <app-about></app-about>
    </div>
  </div>
</div>

@if (!loading() && !error() && currentView() === 'posts') {
  <div class="pagination">
    <div class="pagination-info">
      Showing {{ posts().length }} of {{ totalCount() }} posts (Page {{ currentPage() }} of {{ totalPages() }})
    </div>
    
    <div class="pagination-controls">
      <button 
        (click)="previousPage()" 
        [disabled]="!hasPreviousPage()" 
        class="pagination-btn">
        Previous
      </button>
      
      @for (page of getPageNumbers(); track page) {
        @if (page === -1) {
          <span class="pagination-ellipsis">...</span>
        } @else {
          <button 
            (click)="goToPage(page)" 
            [class.active]="page === currentPage()"
            class="pagination-btn page-number">
            {{ page }}
          </button>
        }
      }
      
      <button 
        (click)="nextPage()" 
        [disabled]="!hasNextPage()" 
        class="pagination-btn">
        Next
      </button>
    </div>
  </div>
}

